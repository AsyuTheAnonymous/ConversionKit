<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DocuConvert - Free Document Converter</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body class="bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 text-gray-100 min-h-screen">
  <!-- Header -->
  <header class="bg-black/20 backdrop-blur-sm border-b border-white/10">
    <nav class="container mx-auto px-6 py-4">
      <div class="flex justify-between items-center">
        <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">
          DocuConvert
        </h1>
        <div class="hidden md:flex space-x-6 items-center">
          <a href="#features" class="hover:text-blue-400 transition duration-300">Features</a>
          <a href="#pricing" class="hover:text-blue-400 transition duration-300">Pricing</a>
          <button id="themeToggle" class="p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors duration-300">
            ☀️
          </button>
        </div>
      </div>
    </nav>
  </header>

  <!-- Hero Section -->
  <section class="container mx-auto px-6 py-12 text-center">
    <h2 class="text-5xl font-bold mb-6 bg-gradient-to-r from-white to-blue-200 bg-clip-text text-transparent">
      Convert Documents Instantly
    </h2>
    <p class="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">
      Transform your files between formats in seconds. No uploads, completely private, and lightning fast.
    </p>
  </section>

  <!-- Converter Tool -->
  <main class="container mx-auto px-6 pb-12">
    <div class="max-w-4xl mx-auto">
      <!-- Conversion Type Selector -->
      <div class="bg-white/5 backdrop-blur-sm rounded-2xl p-8 border border-white/10 shadow-2xl mb-8">
        <h3 class="text-2xl font-bold mb-6 text-center">Choose Conversion Type</h3>
        <div class="grid md:grid-cols-3 lg:grid-cols-4 gap-4 mb-8">
          <button onclick="setConversionType('pdf-to-text')" aria-label="Convert PDF to Text"
                  class="conversion-btn bg-blue-600/20 hover:bg-blue-600/40 border border-blue-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">📄</div>
            <div class="font-semibold">PDF to Text</div>
          </button>
          <button onclick="setConversionType('docx-to-html')" aria-label="Convert DOCX to HTML"
                  class="conversion-btn bg-green-600/20 hover:bg-green-600/40 border border-green-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">📝</div>
            <div class="font-semibold">DOCX to HTML</div>
          </button>
          <button onclick="setConversionType('text-to-pdf')" aria-label="Convert Text to PDF"
                  class="conversion-btn bg-purple-600/20 hover:bg-purple-600/40 border border-purple-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">📋</div>
            <div class="font-semibold">Text to PDF</div>
          </button>
          <button onclick="setConversionType('csv-to-json')" aria-label="Convert CSV to JSON"
                  class="conversion-btn bg-orange-600/20 hover:bg-orange-600/40 border border-orange-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">📊</div>
            <div class="font-semibold">CSV to JSON</div>
          </button>
          <button onclick="setConversionType('json-to-csv')" aria-label="Convert JSON to CSV"
                  class="conversion-btn bg-teal-600/20 hover:bg-teal-600/40 border border-teal-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">🔄</div>
            <div class="font-semibold">JSON to CSV</div>
          </button>
          <button onclick="setConversionType('html-to-pdf')" aria-label="Convert HTML to PDF"
                  class="conversion-btn bg-red-600/20 hover:bg-red-600/40 border border-red-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">🌐</div>
            <div class="font-semibold">HTML to PDF</div>
          </button>
          <button onclick="setConversionType('markdown-to-html')" aria-label="Convert Markdown to HTML"
                  class="conversion-btn bg-indigo-600/20 hover:bg-indigo-600/40 border border-indigo-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">📋</div>
            <div class="font-semibold">Markdown to HTML</div>
          </button>
          <button onclick="setConversionType('base64-encode')" aria-label="Encode to Base64"
                  class="conversion-btn bg-pink-600/20 hover:bg-pink-600/40 border border-pink-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">🔐</div>
            <div class="font-semibold">Base64 Encode</div>
          </button>
          <button onclick="setConversionType('base64-decode')" aria-label="Decode from Base64"
                  class="conversion-btn bg-cyan-600/20 hover:bg-cyan-600/40 border border-cyan-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">🔓</div>
            <div class="font-semibold">Base64 Decode</div>
          </button>
          <button onclick="setConversionType('url-encode')" aria-label="URL Encode"
                  class="conversion-btn bg-yellow-600/20 hover:bg-yellow-600/40 border border-yellow-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">🔗</div>
            <div class="font-semibold">URL Encode</div>
          </button>
          <button onclick="setConversionType('url-decode')" aria-label="URL Decode"
                  class="conversion-btn bg-emerald-600/20 hover:bg-emerald-600/40 border border-emerald-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">🔗</div>
            <div class="font-semibold">URL Decode</div>
          </button>
          <button onclick="setConversionType('xml-to-json')" aria-label="Convert XML to JSON"
                  class="conversion-btn bg-violet-600/20 hover:bg-violet-600/40 border border-violet-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">⚡</div>
            <div class="font-semibold">XML to JSON</div>
          </button>
          <button onclick="setConversionType('text-to-uppercase')" aria-label="Convert Text to Uppercase"
                  class="conversion-btn bg-gray-600/20 hover:bg-gray-600/40 border border-gray-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">⬆️</div>
            <div class="font-semibold">Text to Uppercase</div>
          </button>
          <button onclick="setConversionType('text-to-lowercase')" aria-label="Convert Text to Lowercase"
                  class="conversion-btn bg-gray-600/20 hover:bg-gray-600/40 border border-gray-500/50 rounded-xl p-4 transition-all duration-300 transform hover:scale-105">
            <div class="text-2xl mb-2">⬇️</div>
            <div class="font-semibold">Text to Lowercase</div>
          </button>
        </div>

        <!-- File Upload Area -->
        <div id="uploadArea" class="border-2 border-dashed border-gray-500/50 rounded-xl p-8 text-center transition-all duration-300 hover:border-blue-400/50 hover:bg-blue-900/10">
          <div class="text-4xl mb-4">📁</div>
          <p class="text-lg mb-4">Drag & drop your file here or click to browse</p>
          <p id="selectedFileName" class="text-sm text-blue-400 mb-4 hidden"></p>
          <input type="file" id="fileInput" class="hidden" accept=".pdf,.docx,.txt,.csv,.json,.html,.htm,.xml" multiple>
          <button onclick="document.getElementById('fileInput').click()" aria-label="Select file for conversion"
                  class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300 transform hover:scale-105">
            Select File
          </button>
        </div>

        <!-- Text Input Area (for text-to-pdf) -->
        <div id="textInputArea" class="hidden mt-6">
          <textarea id="textInput" placeholder="Enter your text here..." aria-label="Text input for conversion"
                    class="w-full h-40 bg-white/5 border border-white/20 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
        </div>

        <!-- Convert Button -->
        <div class="text-center mt-6">
          <button id="convertBtn" onclick="convertFile()" aria-label="Convert selected file or text"
                  class="bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white font-bold py-3 px-8 rounded-xl transition-all duration-300 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed"
                  disabled>
            Convert File
          </button>
        </div>

        <!-- Progress Bar -->
        <div id="progressArea" class="hidden mt-6">
          <div class="bg-gray-700 rounded-full h-3 overflow-hidden">
            <div id="progressBar" class="bg-gradient-to-r from-blue-500 to-purple-500 h-full transition-all duration-300" style="width: 0%"></div>
          </div>
          <p id="progressText" class="text-center mt-2 text-gray-300">Processing...</p>
        </div>

        <!-- Result Area -->
        <div id="resultArea" class="hidden mt-6 p-6 bg-green-900/20 border border-green-500/50 rounded-xl">
          <div class="text-center">
            <div class="text-2xl mb-2">✅</div>
            <p class="text-lg font-semibold mb-4">Conversion Complete!</p>
            <div id="downloadSection"></div>
          </div>
        </div>

        <!-- Error Area -->
        <div id="errorArea" class="hidden mt-6 p-6 bg-red-900/20 border border-red-500/50 rounded-xl">
          <div class="text-center">
            <div class="text-2xl mb-2">❌</div>
            <p class="text-lg font-semibold mb-2">Conversion Failed</p>
            <p id="errorMessage" class="text-gray-300"></p>
          </div>
        </div>
      </div>

      <!-- Encoding/Decoding Tools -->
      <div class="bg-white/5 backdrop-blur-sm rounded-2xl p-8 border border-white/10 shadow-2xl mb-8">
        <h3 class="text-2xl font-bold mb-6 text-center">Encoding/Decoding Tools</h3>

        <!-- URL Encode -->
        <div class="mb-6">
          <label for="urlEncodeInput" class="block text-gray-300 text-sm font-bold mb-2">URL Encode:</label>
          <textarea id="urlEncodeInput" placeholder="Enter text to URL encode" aria-label="Input for URL encode"
                    class="w-full h-20 bg-white/5 border border-white/20 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
          <div class="flex justify-end mt-2">
            <button onclick="urlEncode()" aria-label="Encode URL"
                    class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-2 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
              Encode
            </button>
          </div>
          <textarea id="urlEncodeOutput" readonly aria-label="Output for URL encode"
                    class="w-full h-20 bg-white/5 border border-white/20 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none mt-2"></textarea>
          <div class="flex justify-end mt-2">
            <button onclick="copyToClipboard('urlEncodeOutput')" aria-label="Copy URL encode output"
                    class="bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white font-bold py-2 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
              Copy
            </button>
          </div>
        </div>

        <!-- Base64 Encode -->
        <div class="mb-6">
          <label for="base64EncodeInput" class="block text-gray-300 text-sm font-bold mb-2">Base64 Encode:</label>
          <textarea id="base64EncodeInput" placeholder="Enter text to Base64 encode" aria-label="Input for Base64 encode"
                    class="w-full h-20 bg-white/5 border border-white/20 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
          <div class="flex justify-end mt-2">
            <button onclick="base64Encode()" aria-label="Encode Base64"
                    class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-bold py-2 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
              Encode
            </button>
          </div>
          <textarea id="base64EncodeOutput" readonly aria-label="Output for Base64 encode"
                    class="w-full h-20 bg-white/5 border border-white/20 rounded-xl p-4 text-white placeholder-gray-400 resize-none focus:outline-none mt-2"></textarea>
          <div class="flex justify-end mt-2">
            <button onclick="copyToClipboard('base64EncodeOutput')" aria-label="Copy Base64 encode output"
                    class="bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white font-bold py-2 px-4 rounded-xl transition-all duration-300 transform hover:scale-105">
              Copy
            </button>
          </div>
        </div>
      </div>

      <!-- Usage Stats -->
      <div class="grid md:grid-cols-3 gap-6 mb-8">
        <div class="bg-white/5 backdrop-blur-sm rounded-xl p-6 text-center border border-white/10">
          <div class="text-3xl font-bold text-blue-400" id="conversionsToday">0</div>
          <div class="text-gray-300">Conversions Today</div>
        </div>
        <div class="bg-white/5 backdrop-blur-sm rounded-xl p-6 text-center border border-white/10">
          <div class="text-3xl font-bold text-green-400">100%</div>
          <div class="text-gray-300">Privacy Protected</div>
        </div>
        <div class="bg-white/5 backdrop-blur-sm rounded-xl p-6 text-center border border-white/10">
          <div class="text-3xl font-bold text-purple-400">Free</div>
          <div class="text-gray-300">No Registration</div>
        </div>
      </div>

      <!-- Ad Space -->
      <div class="bg-white/5 backdrop-blur-sm rounded-xl p-8 text-center border border-white/10">
        <p class="text-gray-400 mb-4">This service is free thanks to our sponsors</p>
        <div class="h-32 bg-gray-800/50 rounded-lg flex items-center justify-center border border-gray-600/50">
          <span class="text-gray-500">Google AdSense Ad Space</span>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-black/20 backdrop-blur-sm border-t border-white/10 py-8 mt-12">
    <div class="container mx-auto px-6 text-center">
      <p class="text-gray-400 mb-2">&copy; 2025 DocuConvert. All files processed locally for maximum privacy.</p>
      <p class="text-gray-400 text-sm">
        <a href="https://forms.gle/your-feedback-form-link" target="_blank" class="text-blue-400 hover:underline">Provide Feedback</a>
      </p>
    </div>
  </footer>

  <script>
    let currentConversionType = null;
    let dailyConversions = 0;
    
    // Try to get from localStorage, but handle if it's not available
    try {
      dailyConversions = parseInt(localStorage.getItem('dailyConversions') || '0');
    } catch (e) {
      // localStorage not available (sandboxed environment), use session variable
      dailyConversions = window.sessionConversions || 0;
    }
    
    // Update counter display
    document.getElementById('conversionsToday').textContent = dailyConversions;

    function setConversionType(type) {
      currentConversionType = type;
      
      // Update UI based on conversion type
      const fileInput = document.getElementById('fileInput');
      const textInputArea = document.getElementById('textInputArea');
      const convertBtn = document.getElementById('convertBtn');
      
      // Reset areas
      hideAllAreas();
      
      if (type === 'text-to-pdf' || type === 'base64-encode' || type === 'base64-decode' || 
          type === 'url-encode' || type === 'url-decode' || type === 'markdown-to-html' ||
          type === 'csv-to-json' || type === 'json-to-csv' || type === 'xml-to-json' || type === 'html-to-pdf') {
        textInputArea.classList.remove('hidden');
        fileInput.accept = ''; // Clear file input accept for text-based conversions
        convertBtn.disabled = false;
        
        // Update placeholder text based on conversion type
        const textInput = document.getElementById('textInput');
        if (type === 'text-to-pdf') {
          textInput.placeholder = 'Enter your text here...';
        } else if (type === 'base64-encode') {
          textInput.placeholder = 'Enter text to encode to Base64...';
        } else if (type === 'base64-decode') {
          textInput.placeholder = 'Enter Base64 string to decode...';
        } else if (type === 'url-encode') {
          textInput.placeholder = 'Enter text/URL to encode...';
        } else if (type === 'url-decode') {
          textInput.placeholder = 'Enter encoded URL to decode...';
        } else if (type === 'markdown-to-html') {
          textInput.placeholder = 'Enter Markdown text here...';
        } else if (type === 'csv-to-json') {
          textInput.placeholder = 'Enter CSV data here...';
        } else if (type === 'json-to-csv') {
          textInput.placeholder = 'Enter JSON data here...';
        } else if (type === 'xml-to-json') {
          textInput.placeholder = 'Enter XML data here...';
        } else if (type === 'html-to-pdf') {
          textInput.placeholder = 'Enter HTML content here...';
        }
      } else {
        textInputArea.classList.add('hidden');
        if (type === 'pdf-to-text') {
          fileInput.accept = '.pdf';
        } else if (type === 'docx-to-html') {
          fileInput.accept = '.docx';
        } else if (type === 'csv-to-json') {
          fileInput.accept = '.csv';
        } else if (type === 'json-to-csv') {
          fileInput.accept = '.json';
        } else if (type === 'html-to-pdf') {
          fileInput.accept = '.html,.htm';
        } else if (type === 'xml-to-json') {
          fileInput.accept = '.xml';
        }
        convertBtn.disabled = true;
      }
      
      // Update button styles
      document.querySelectorAll('.conversion-btn').forEach(btn => {
          btn.classList.remove('ring-2', 'ring-blue-400');
        });
        event.target.closest('.conversion-btn').classList.add('ring-2', 'ring-blue-400');
      }

      function hideAllAreas() {
        document.getElementById('progressArea').classList.add('hidden');
        document.getElementById('resultArea').classList.add('hidden');
        document.getElementById('errorArea').classList.add('hidden');
      }

      function showProgress() {
        document.getElementById('progressArea').classList.remove('hidden');
        let progress = 0;
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        
        const interval = setInterval(() => {
          progress += Math.random() * 30;
          if (progress > 90) progress = 90;
          progressBar.style.width = progress + '%';
          progressText.textContent = `Processing... ${Math.round(progress)}%`;
          
          if (progress >= 90) {
            clearInterval(interval);
          }
        }, 200);
        
        return interval;
      }

      function completeProgress() {
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        progressBar.style.width = '100%';
        progressText.textContent = 'Complete!';
        
        setTimeout(() => {
          document.getElementById('progressArea').classList.add('hidden');
          document.getElementById('resultArea').classList.remove('hidden');
        }, 500);
      }

      function showError(message) {
        document.getElementById('progressArea').classList.add('hidden');
        document.getElementById('errorMessage').textContent = message;
        document.getElementById('errorArea').classList.add('hidden');
      }

      function downloadFile(blob, filename) {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      }

    async function convertFile() {
      if (!currentConversionType) {
        showError('Please select a conversion type first.');
        return;
      }

      hideAllAreas();
      const progressInterval = showProgress();

      try {
        const files = document.getElementById('fileInput').files;
        const textInput = document.getElementById('textInput');
        let results = [];

        if (currentConversionType.includes('text-to-') || currentConversionType.includes('base64-') || currentConversionType.includes('url-') || currentConversionType === 'markdown-to-html') {
          // Handle text-based conversions
          if (!textInput.value.trim()) {
            throw new Error('Please enter some text to convert.');
          }
          let result;
          if (currentConversionType === 'text-to-pdf') {
            result = await convertTextToPdf();
          } else if (currentConversionType === 'base64-encode') {
            result = await convertBase64Encode();
          } else if (currentConversionType === 'base64-decode') {
            result = await convertBase64Decode();
          } else if (currentConversionType === 'url-encode') {
            result = await convertUrlEncode();
          } else if (currentConversionType === 'url-decode') {
            result = await convertUrlDecode();
          } else if (currentConversionType === 'markdown-to-html') {
            result = await convertMarkdownToHtml();
          } else if (currentConversionType === 'text-to-uppercase') {
            result = await convertTextToUppercase();
          } else if (currentConversionType === 'text-to-lowercase') {
            result = await convertTextToLowercase();
          }
          results.push(result);
        } else {
          // Handle file-based conversions (including batch)
          if (files.length === 0) {
            throw new Error('Please select one or more files.');
          }

          for (const file of files) {
            let result;
            if (currentConversionType === 'pdf-to-text') {
              result = await convertPdfToText(file);
            } else if (currentConversionType === 'docx-to-html') {
              result = await convertDocxToHtml(file);
            } else if (currentConversionType === 'csv-to-json') {
              result = await convertCsvToJson(file);
            } else if (currentConversionType === 'json-to-csv') {
              result = await convertJsonToCsv(file);
            } else if (currentConversionType === 'html-to-pdf') {
              result = await convertHtmlToPdf(file);
            } else if (currentConversionType === 'xml-to-json') {
              result = await convertXmlToJson(file);
            }
            results.push(result);
          }
        }

        clearInterval(progressInterval);
        completeProgress();
        
        // Update download section for single or multiple results
        const downloadSection = document.getElementById('downloadSection');
        downloadSection.innerHTML = ''; // Clear previous results

        if (results.length === 1) {
          const result = results[0];
          downloadSection.innerHTML = `
            <button onclick="downloadFile(window.lastConversionResult.blob, '${result.filename}')" 
                    class="bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300">
              Download ${result.filename}
            </button>
          `;
          window.lastConversionResult = result; // Store for single download
        } else if (results.length > 1) {
          // For multiple files, offer a ZIP download
          const zip = new JSZip();
          for (const res of results) {
            zip.file(res.filename, res.blob);
          }
          const zipBlob = await zip.generateAsync({ type: 'blob' });
          downloadSection.innerHTML = `
            <button onclick="downloadFile(window.lastConversionResult.blob, 'converted_files.zip')" 
                    class="bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white font-bold py-3 px-6 rounded-xl transition-all duration-300">
              Download All (${results.length} files) as ZIP
            </button>
          `;
          window.lastConversionResult = { blob: zipBlob, filename: 'converted_files.zip' };
        }
        
        // Update conversion counter
        dailyConversions += results.length;
        try {
          localStorage.setItem('dailyConversions', dailyConversions.toString());
        } catch (e) {
          window.sessionConversions = dailyConversions;
        }
        document.getElementById('conversionsToday').textContent = dailyConversions;
        
      } catch (error) {
        clearInterval(progressInterval);
        showError(error.message);
      }
    }

    async function convertPdfToText(file) {
      if (!file) {
        throw new Error('Please select a PDF file.');
      }

      const arrayBuffer = await file.arrayBuffer();
      
      // Load PDF
      const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
      let fullText = '';
      
      // Extract text from each page
      for (let i = 1; i <= pdf.numPages; i++) {
        const page = await pdf.getPage(i);
        const textContent = await page.getTextContent();
        const pageText = textContent.items.map(item => item.str).join(' ');
        fullText += pageText + '\n\n';
      }
      
      const blob = new Blob([fullText], { type: 'text/plain' });
      const filename = file.name.replace('.pdf', '.txt');
      
      return { blob, filename };
    }

    async function convertDocxToHtml(file) {
      if (!file) {
        throw new Error('Please select a DOCX file.');
      }

      const arrayBuffer = await file.arrayBuffer();
      
      // Convert DOCX to HTML using mammoth
      const result = await mammoth.convertToHtml({ arrayBuffer });
      const html = `
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Converted Document</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
          </style>
        </head>
        <body>
          ${result.value}
        </body>
        </html>
      `;
      
      const blob = new Blob([html], { type: 'text/html' });
      const filename = file.name.replace('.docx', '.html');
      
      return { blob, filename };
    }

    async function convertTextToPdf() {
      const textInput = document.getElementById('textInput');
      const text = textInput.value.trim();
      
      if (!text) {
        throw new Error('Please enter some text to convert.');
      }

      // Create PDF using PDF-lib
      const pdfDoc = await PDFLib.PDFDocument.create();
      const page = pdfDoc.addPage([595.28, 841.89]); // A4 size
      
      const fontSize = 12;
      const font = await pdfDoc.embedFont(PDFLib.StandardFonts.Helvetica);
      
      // Split text into lines that fit on the page
      const maxWidth = 500;
      const lines = [];
      const words = text.split(' ');
      let currentLine = '';
      
      for (const word of words) {
        const testLine = currentLine + (currentLine ? ' ' : '') + word;
        const width = font.widthOfTextAtSize(testLine, fontSize);
        
        if (width > maxWidth && currentLine) {
          lines.push(currentLine);
          currentLine = word;
        } else {
          currentLine = testLine;
        }
      }
      if (currentLine) lines.push(currentLine);
      
      // Add text to PDF
      let yPosition = 750;
      for (const line of lines) {
        if (yPosition < 50) {
          // Add new page if needed
          const newPage = pdfDoc.addPage([595.28, 841.89]);
          yPosition = 750;
          newPage.drawText(line, {
            x: 50,
            y: yPosition,
            size: fontSize,
            font: font,
          });
        } else {
          page.drawText(line, {
            x: 50,
            y: yPosition,
            size: fontSize,
            font: font,
          });
        }
        yPosition -= 20;
      }
      
      const pdfBytes = await pdfDoc.save();
      const blob = new Blob([pdfBytes], { type: 'application/pdf' });
      const filename = 'converted-text.pdf';
      
      return { blob, filename };
    }

    // File input handler
    document.getElementById('fileInput').addEventListener('change', function(e) {
      if (e.target.files[0]) {
        const fileName = e.target.files[0].name;
        const fileNameDisplay = document.getElementById('selectedFileName');
        fileNameDisplay.textContent = `Selected: ${fileName}`;
        fileNameDisplay.classList.remove('hidden');
        document.getElementById('convertBtn').disabled = false;
      }
    });

    // Text input handler
    document.getElementById('textInput').addEventListener('input', function(e) {
      const convertBtn = document.getElementById('convertBtn');
      const textBasedConversions = ['text-to-pdf', 'base64-encode', 'base64-decode', 
                                   'url-encode', 'url-decode', 'markdown-to-html'];
      if (textBasedConversions.includes(currentConversionType)) {
        convertBtn.disabled = !e.target.value.trim();
      }
    });

    // Drag and drop functionality
    const uploadArea = document.getElementById('uploadArea');
    
    uploadArea.addEventListener('dragover', function(e) {
      e.preventDefault();
      uploadArea.classList.add('border-blue-400/70', 'bg-blue-900/20');
    });
    
    uploadArea.addEventListener('dragleave', function(e) {
      e.preventDefault();
      uploadArea.classList.remove('border-blue-400/70', 'bg-blue-900/20');
      
      const files = e.dataTransfer.files;
      if (files.length > 0) {
        document.getElementById('fileInput').files = files;
        const fileName = files[0].name;
        const fileNameDisplay = document.getElementById('selectedFileName');
        fileNameDisplay.textContent = `Selected: ${fileName}`;
        fileNameDisplay.classList.remove('hidden');
        if (currentConversionType !== 'text-to-pdf') {
          document.getElementById('convertBtn').disabled = false;
        }
      }
    });

    function urlEncode() {
      const input = document.getElementById('urlEncodeInput').value;
      const output = document.getElementById('urlEncodeOutput');
      output.value = encodeURIComponent(input);
    }

    function base64Encode() {
      const input = document.getElementById('base64EncodeInput').value;
      const output = document.getElementById('base64EncodeOutput');
      output.value = btoa(input);
    }

    function copyToClipboard(elementId) {
      const element = document.getElementById(elementId);
      element.select();
      document.execCommand('copy');

      // Provide visual feedback
      const originalText = element.value;
      element.value = 'Copied!';
      setTimeout(() => {
        element.value = originalText;
      }, 1000);
    }

    async function convertCsvToJson(file) {
      if (!file) {
        throw new Error('Please select a CSV file.');
      }

      const text = await file.text();
      
      // Simple CSV parser
      const lines = text.split('\n').filter(line => line.trim());
      if (lines.length === 0) throw new Error('CSV file is empty');
      
      const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
      const data = [];
      
      for (let i = 1; i < lines.length; i++) {
        const values = lines[i].split(',').map(v => v.trim().replace(/"/g, ''));
        if (values.length === headers.length) {
          const row = {};
          headers.forEach((header, index) => {
            row[header] = values[index];
          });
          data.push(row);
        }
      }
      
      const jsonString = JSON.stringify(data, null, 2);
      const blob = new Blob([jsonString], { type: 'application/json' });
      const filename = file.name.replace('.csv', '.json');
      
      return { blob, filename };
    }

    async function convertJsonToCsv(file) {
      if (!file) {
        throw new Error('Please select a JSON file.');
      }

      const text = await file.text();
      
      try {
        const data = JSON.parse(text);
        if (!Array.isArray(data) || data.length === 0) {
          throw new Error('JSON must be an array of objects');
        }
        
        // Get headers from first object
        const headers = Object.keys(data[0]);
        let csv = headers.join(',') + '\n';
        
        // Add data rows
        data.forEach(row => {
          const values = headers.map(header => {
            const value = row[header] || '';
            return typeof value === 'string' && value.includes(',') ? `"${value}"` : value;
          });
          csv += values.join(',') + '\n';
        });
        
        const blob = new Blob([csv], { type: 'text/csv' });
        const filename = file.name.replace('.json', '.csv');
        
        return { blob, filename };
      } catch (error) {
        throw new Error('Invalid JSON format');
      }
    }

    async function convertHtmlToPdf(file) {
      if (!file) {
        throw new Error('Please select an HTML file.');
      }

      const htmlContent = await file.text();
      
      // Create PDF using PDF-lib
      const pdfDoc = await PDFLib.PDFDocument.create();
      const page = pdfDoc.addPage([595.28, 841.89]); // A4 size
      
      // Strip HTML tags and extract text content
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = htmlContent;
      const textContent = tempDiv.textContent || tempDiv.innerText || '';
      
      const fontSize = 12;
      const font = await pdfDoc.embedFont(PDFLib.StandardFonts.Helvetica);
      
      // Split text into lines that fit on the page
      const maxWidth = 500;
      const lines = [];
      const words = textContent.split(' ');
      let currentLine = '';
      
      for (const word of words) {
        const testLine = currentLine + (currentLine ? ' ' : '') + word;
        const width = font.widthOfTextAtSize(testLine, fontSize);
        
        if (width > maxWidth && currentLine) {
          lines.push(currentLine);
          currentLine = word;
        } else {
          currentLine = testLine;
        }
      }
      if (currentLine) lines.push(currentLine);
      
      // Add text to PDF
      let yPosition = 750;
      for (const line of lines) {
        if (yPosition < 50) {
          break; // Simple version - just fill first page
        }
        page.drawText(line, {
          x: 50,
          y: yPosition,
          size: fontSize,
          font: font,
        });
        yPosition -= 20;
      }
      
      const pdfBytes = await pdfDoc.save();
      const blob = new Blob([pdfBytes], { type: 'application/pdf' });
      const filename = file.name.replace(/\.(html|htm)$/, '.pdf');
      
      return { blob, filename };
    }

    async function convertMarkdownToHtml() {
      const textInput = document.getElementById('textInput');
      const markdown = textInput.value.trim();
      
      if (!markdown) {
        throw new Error('Please enter Markdown text to convert.');
      }

      // Simple Markdown to HTML converter
      let html = markdown
        // Headers
        .replace(/^### (.*$)/gim, '<h3>$1</h3>')
        .replace(/^## (.*$)/gim, '<h2>$1</h2>')
        .replace(/^# (.*$)/gim, '<h1>$1</h1>')
        // Bold
        .replace(/\*\*(.*)\*\*/gim, '<strong>$1</strong>')
        .replace(/__(.*?)__/gim, '<strong>$1</strong>')
        // Italic
        .replace(/\*(.*)\*/gim, '<em>$1</em>')
        .replace(/_(.*?)_/gim, '<em>$1</em>')
        // Code
        .replace(/`(.*?)`/gim, '<code>$1</code>')
        // Links
        .replace(/\[([^\]]*)\]\(([^\)]*)\)/gim, '<a href="$2">$1</a>')
        // Line breaks
        .replace(/\n/gim, '<br>');

      const fullHtml = `
        <!DOCTYPE html>
        <html>
        <head>
          <meta charset="UTF-8">
          <title>Converted from Markdown</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
            h1, h2, h3 { color: #333; }
            code { background: #f4f4f4; padding: 2px 4px; border-radius: 3px; }
            a { color: #0066cc; }
          </style>
        </head>
        <body>
          ${html}
        </body>
        </html>
      `;
      
      const blob = new Blob([fullHtml], { type: 'text/html' });
      const filename = 'converted-markdown.html';
      
      return { blob, filename };
    }

    async function convertBase64Encode() {
      const textInput = document.getElementById('textInput');
      const text = textInput.value.trim();
      
      if (!text) {
        throw new Error('Please enter text to encode.');
      }

      const encoded = btoa(unescape(encodeURIComponent(text)));
      const blob = new Blob([encoded], { type: 'text/plain' });
      const filename = 'base64-encoded.txt';
      
      return { blob, filename };
    }

    async function convertBase64Decode() {
      const textInput = document.getElementById('textInput');
      const base64Text = textInput.value.trim();
      
      if (!base64Text) {
        throw new Error('Please enter Base64 text to decode.');
      }

      try {
        const decoded = decodeURIComponent(escape(atob(base64Text)));
        const blob = new Blob([decoded], { type: 'text/plain' });
        const filename = 'base64-decoded.txt';
        
        return { blob, filename };
      } catch (error) {
        throw new Error('Invalid Base64 format');
      }
    }

    async function convertUrlEncode() {
      const textInput = document.getElementById('textInput');
      const text = textInput.value.trim();
      
      if (!text) {
        throw new Error('Please enter text to URL encode.');
      }

      const encoded = encodeURIComponent(text);
      const blob = new Blob([encoded], { type: 'text/plain' });
      const filename = 'url-encoded.txt';
      
      return { blob, filename };
    }

    async function convertUrlDecode() {
      const textInput = document.getElementById('textInput');
      const encodedText = textInput.value.trim();
      
      if (!encodedText) {
        throw new Error('Please enter URL encoded text to decode.');
      }

      try {
        const decoded = decodeURIComponent(encodedText);
        const blob = new Blob([decoded], { type: 'text/plain' });
        const filename = 'url-decoded.txt';
        
        return { blob, filename };
      } catch (error) {
        throw new Error('Invalid URL encoded format');
      }
    }

    async function convertXmlToJson(file) {
      if (!file) {
        throw new Error('Please select an XML file.');
      }

      const xmlText = await file.text();
      
      try {
        // Simple XML to JSON converter
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
        
        function xmlToJson(xml) {
          const obj = {};
          
          if (xml.hasChildNodes()) {
            for (let i = 0; i < xml.childNodes.length; i++) {
              const item = xml.childNodes.item(i);
              const nodeName = item.nodeName;
              
              if (typeof obj[nodeName] === 'undefined') {
                obj[nodeName] = xmlToJson(item);
              } else {
                if (typeof obj[nodeName].push === 'undefined') {
                  const old = obj[nodeName];
                  obj[nodeName] = [];
                  obj[nodeName].push(old);
                }
                obj[nodeName].push(xmlToJson(item));
              }
            }
          } else {
            obj.textContent = xml.textContent;
          }
          
          return obj;
        }
        
        const result = xmlToJson(xmlDoc);
        const jsonString = JSON.stringify(result, null, 2);
        const blob = new Blob([jsonString], { type: 'application/json' });
        const filename = file.name.replace('.xml', '.json');
        
        return { blob, filename };
      } catch (error) {
        throw new Error('Invalid XML format');
      }
    }

    async function convertTextToUppercase() {
      const textInput = document.getElementById('textInput');
      const text = textInput.value.trim();
      
      if (!text) {
        throw new Error('Please enter text to convert.');
      }

      const uppercasedText = text.toUpperCase();
      const blob = new Blob([uppercasedText], { type: 'text/plain' });
      const filename = 'uppercased-text.txt';
      
      return { blob, filename };
    }

    async function convertTextToLowercase() {
      const textInput = document.getElementById('textInput');
      const text = textInput.value.trim();
      
      if (!text) {
        throw new Error('Please enter text to convert.');
      }

      const lowercasedText = text.toLowerCase();
      const blob = new Blob([lowercasedText], { type: 'text/plain' });
      const filename = 'lowercased-text.txt';
      
      return { blob, filename };
    }

    // Theme toggle functionality
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;

    // Check for saved theme preference
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
      body.classList.add(savedTheme);
      if (savedTheme === 'light-mode') {
        themeToggle.textContent = '🌙';
      } else {
        themeToggle.textContent = '☀️';
      }
    } else {
      // Default to dark mode if no preference
      body.classList.add('dark-mode');
      themeToggle.textContent = '☀️';
    }

    themeToggle.addEventListener('click', () => {
      if (body.classList.contains('dark-mode')) {
        body.classList.remove('dark-mode');
        body.classList.add('light-mode');
        themeToggle.textContent = '🌙';
        localStorage.setItem('theme', 'light-mode');
      } else {
        body.classList.remove('light-mode');
        body.classList.add('dark-mode');
        themeToggle.textContent = '☀️';
        localStorage.setItem('theme', 'dark-mode');
      }
    });
  </script>
</body>
</html>
